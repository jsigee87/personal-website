<!DOCTYPE html>
<html lang="en-us">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">




<base href="https://www.johnsigmon.me/">

<title>
  John Sigmon - Bash Tips 
</title>

<meta name="generator" content="Hugo 0.69.0" />



<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400|Roboto+Slab:400,700|Roboto:300,300i,400,400i,500,500i,700,700i">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
<link rel="stylesheet" href="https://www.johnsigmon.me/css/main.css">
<link rel="stylesheet" href="https://www.johnsigmon.me/css/custom.css">




<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">

</head>
<body lang="en-us">
<div class="container">


<header class="row text-left title">
  <h1 class="title">Bash Tips</h1>
</header>
<section id="category-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-left meta">
        PUBLISHED ON APR 26, 2020 
      
      
      
      â€”
      
      
      <a class="meta" href="/categories/bash">BASH</a>, 
      
      <a class="meta" href="/categories/development">DEVELOPMENT</a>
      
      
      
    </h6>
  </div>
  
</section>
<section id="content-pane" class="row">
  <div class="col-md-12 text-justify content">
    
    <h2 id="redirects">Redirects</h2>
<p>All those fun redirect operators are outlined really well in this <a href="https://unix.stackexchange.com/questions/159513/what-are-the-shells-control-and-redirection-operators">Stack Overflow post</a>.</p>
<h2 id="grep-awk-and-sed">Grep, Awk, and Sed</h2>
<p>Grep is one of the most flexible and useful Linux utilities, Awk is actually a full blown programming language, and Sed isn&rsquo;t too bad either. This <a href="https://www-users.york.ac.uk/~mijp1/teaching/2nd_year_Comp_Lab/guides/grep_awk_sed.pdf">9 page overview</a> gives some good tips to get started without being overly long and verbose.</p>
<h2 id="comparison-operators">Comparison Operators</h2>
<p>The cases of comparing strings versus comparing variables are handled a little differently in bash. <a href="https://www.tldp.org/LDP/abs/html/comparison-ops.html">This</a> is an excellent guide. Note the whitespace! Bash is particular about whitespace.</p>
<h2 id="checking-if-a-variable-is-empty">Checking if a Variable is Empty</h2>
<p>Example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$var<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>
<span style="color:#66d9ef">then</span>
    <span style="color:#75715e"># var is empty</span>
<span style="color:#66d9ef">else</span>
    <span style="color:#75715e"># var is not empty</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><h2 id="checking-exit-codes">Checking Exit Codes</h2>
<p>The proper way to check out an exit code is C-style, and can be a little confusing. Example stolen from <a href="https://stackoverflow.com/questions/26675681/how-to-check-the-exit-status-using-an-if-statement-using-bash">this</a> Stack Overflow post.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">if</span> some_command
<span style="color:#66d9ef">then</span>
    <span style="color:#75715e"># command returned true</span>
<span style="color:#66d9ef">else</span>
    <span style="color:#75715e"># command returned some error</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>or inverted:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">if</span> ! some_command
<span style="color:#66d9ef">then</span>
    <span style="color:#75715e"># command returned some error</span>
<span style="color:#66d9ef">else</span>
    <span style="color:#75715e"># command returned true</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><h2 id="checking-apt-versions">Checking Apt Versions</h2>
<p>Ex.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ apt-cache policy libgtest-dev
libgtest-dev:
  Installed: 1.7.0-4ubuntu1
  Candidate: 1.7.0-4ubuntu1
  Version table:
 *** 1.7.0-4ubuntu1 <span style="color:#ae81ff">500</span>
        <span style="color:#ae81ff">500</span> http://us.archive.ubuntu.com/ubuntu xenial/universe amd64 Packages
        <span style="color:#ae81ff">100</span> /var/lib/dpkg/status
</code></pre></div><p>Here the version is <code>1.7.0-4ubuntu1</code> and this version can be installed by running:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">apt-get install libgtest-dev<span style="color:#f92672">=</span>1.7.0-4ubuntu1
</code></pre></div><h2 id="checking-the-beginning-of-a-large-file">Checking the Beginning of a Large File</h2>
<p>In a simple case, head is useful:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># This gives the first ten lines</span>
head large_file 

<span style="color:#75715e"># This gives the first 25 lines</span>
head -25 large_file 
</code></pre></div><p>For more complicated cases head has other flags, or you can use cut:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># This gives the first 100 bytes</span>
head -c <span style="color:#ae81ff">100</span> large_file 

<span style="color:#75715e"># This gives the first 100 characters</span> 
<span style="color:#75715e"># (useful for debugging JSON loading errors!)</span>
cut -c1-100 &lt; large_file

<span style="color:#75715e"># The above command is equivalent to</span>
cat large_file | cut -c1-100
</code></pre></div><h2 id="custom-logging-statements">Custom logging statements</h2>
<p>A practice I am in the habit of is placing a variable at the top of scripts called <code>MYFILENAME</code>. I have found it useful for logging and usage statements.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">MYFILENAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;myscript.sh&#34;</span>

<span style="color:#75715e"># LINENO is built in</span> 
echo <span style="color:#e6db74">&#34;[INFO: </span>$MYFILENAME<span style="color:#e6db74">: </span>$LINENO<span style="color:#e6db74">] Starting myscript.sh&#34;</span>
</code></pre></div><p>This becomes helpful when you have large and complicated bash scripts that need to work together.</p>
<h2 id="casing-arguments">Casing Arguments</h2>
<p>This has worked well for me to case out command line args. You may need other checks to ensure the correct variables were passed in. If you pass in an extra arg thats not supported this does not catch it. This example is something I commonly have to parse out for deployment scripts. If the flag <code>--dev</code> is found, I set a <code>DEV</code> flag to true, etc.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># While there are still arguments to parse</span>
<span style="color:#66d9ef">while</span> <span style="color:#f92672">[[</span> $# -gt <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span>
<span style="color:#66d9ef">do</span>
key<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># Case them out</span>
<span style="color:#66d9ef">case</span> $key in
    --dev<span style="color:#f92672">)</span>
    DEV<span style="color:#f92672">=</span>true
    shift
    ;;
    --prod<span style="color:#f92672">)</span>
    PROD<span style="color:#f92672">=</span>true
    shift
    ;;
<span style="color:#66d9ef">esac</span>
<span style="color:#66d9ef">done</span>
</code></pre></div><h2 id="figuring-out-where-your-file-is">Figuring Out Where Your File Is</h2>
<p>You want someone to be able to run your script from multiple locations, but the script may need to move around within a repository to access different files. A simple and <em>relatively</em> robust way to manage this is by figuring out the directory your script is located in, and <code>cd</code>-ing to that directory. This snippet should take care of that.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cd <span style="color:#66d9ef">$(</span>dirname <span style="color:#e6db74">&#34;</span>$0<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span>
</code></pre></div><h2 id="using-shellcheck">Using Shellcheck</h2>
<p>If you have never used it, <a href="https://github.com/koalaman/shellcheck">shellcheck</a> is a fantastic shell linter. Install and set up is easy, there is no reason not to use it. I found it to be accurate and helpful, and definitely not too picky.</p>
<h2 id="iterating-over-an-array">Iterating Over an Array</h2>
<p>I always forget the syntax for this, so here is an example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SAMPLE_LIST<span style="color:#f92672">=(</span>
    <span style="color:#e6db74">&#34;list item 1&#34;</span>
    <span style="color:#e6db74">&#34;list item 2&#34;</span>
<span style="color:#f92672">)</span>


<span style="color:#66d9ef">for</span> item in <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SAMPLE_LIST[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">do</span>
    <span style="color:#75715e"># Access the item like this</span>
    echo <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>item<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">done</span>
</code></pre></div><h2 id="bash-array-reference">Bash array reference</h2>
<p>This is a great reference for bash arrays:</p>
<p><a href="https://tldp.org/LDP/abs/html/arrays.html">https://tldp.org/LDP/abs/html/arrays.html</a></p>

  </div>
</section>
<section id="tag-pane" class="row meta">
  
  <div class="col-md-12">
    <h6 class="text-right meta">
      
    </h6>
  </div>
  
</section>








<section id="menu-pane" class="row menu text-center">
  
  
  <span><a class="menu-item" href="https://www.johnsigmon.me/technical/git-tips/">&lt; prev | </a></span>
  
  
  <span><a class="menu-item" href="/technical">technical</a></span>
  
  
  
  <h4 class="text-center"><a class="menu-item" href="https://www.johnsigmon.me/">home</a></h4>
</section>



<footer class="row text-center footer">
  <hr />
  
</footer>

</div>




<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="js/main.js"></script>
<script src="js/custom.js"></script>
</body>
</html>


